// API Gateway configuration
// This file defines the configuration structure for an API Gateway, including server and downstream client configurations
syntax = "proto3";

// Package name to prevent naming conflicts
package examples.api_gateway;

// Import server and client building block containers provided by the framework
import "runtime/config/v1/server.proto";
import "runtime/config/v1/client.proto";
// Import client configuration related to service discovery
// import "runtime/discovery/v1/endpoint.proto"; // Deprecated, removed from here

// Specify the import path and package name for the generated Go code
option go_package = "./api_gateway/conf;conf";

// Bootstrap is the top-level configuration for an API Gateway
// This configuration initializes an API Gateway service that can provide multiple server interfaces
// and call multiple downstream microservices
message Bootstrap {
  // Server configuration list
  // Gateways typically expose multiple server interfaces, for example:
  // - HTTP RESTful API for external access
  // - gRPC interface
  // - - WebSocket service
  repeated runtime.config.v1.Server servers = 1;

  // Downstream client configuration mapping
  // The key is the logical name of the client, used to reference specific clients in code
  // For example:
  // - "user-service-client"
  // - "order-service-client"
  map<string, ClientConfig> clients = 2; 
}

// ClientConfig combines all configurations needed for a client
// It now directly wraps the runtime.config.v1.Client message.
message ClientConfig {
  // Transport-level client configuration, now encapsulating all client-side settings.
  runtime.config.v1.Client client = 1;
}
