syntax = "proto3";

package runtime.security.v1;

import "runtime/security/authn/v1/authn.proto";
import "runtime/security/authz/v1/authz.proto";
import "runtime/security/transport/v1/tls.proto";

option go_package = "github.com/origadmin/runtime/api/gen/go/runtime/security/v1;securityv1";

// Security defines the top-level configuration for all security-related components.
message Security {
  // List of authentication configurations.
  AuthNConfigs authn_configs = 1;
  // List of authorization configurations.
  AuthZConfigs authz_configs = 2;
  // List of transport layer security (TLS) configurations.
  TransportSecurityConfigs transport_security_configs = 3;
}

message AuthNConfigs {
  optional string default = 1 [json_name = "default"];
  optional string active = 2 [json_name = "active"];
  repeated runtime.security.authn.v1.AuthN configs = 3 [json_name = "configs"];
}

message AuthZConfigs {
  optional string default = 1 [json_name = "default"];
  optional string active = 2 [json_name = "active"];
  repeated runtime.security.authz.v1.AuthZ configs = 3 [json_name = "configs"];
}

message TransportSecurityConfigs {
  optional string default = 1 [json_name = "default"];
  optional string active = 2 [json_name = "active"];
  repeated runtime.security.transport.v1.TLSConfig configs = 3 [json_name = "configs"];
}
