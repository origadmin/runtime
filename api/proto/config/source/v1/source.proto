syntax = "proto3";

package runtime.api.config.source.v1;

import "config/security/transport/v1/tls.proto";
import "config/source/v1/apollo_source.proto";
import "config/source/v1/consul_source.proto";
import "config/source/v1/env_source.proto";
import "config/source/v1/etcd_source.proto";
import "config/source/v1/file_source.proto";
import "config/source/v1/kubernetes_source.proto";
import "config/source/v1/nacos_source.proto";
import "config/source/v1/polaris_source.proto";
import "google/protobuf/struct.proto";
import "validate/validate.proto";

option go_package = "github.com/origadmin/runtime/api/gen/go/config/source/v1;sourcev1";

message Sources {
  // name specifies the configuration set name
  string name = 1 [json_name = "name"];
  // version specifies the configuration set version
  string version = 2 [json_name = "version"];
  // sources is a list of configuration sources
  repeated SourceConfig configs = 3 [json_name = "configs"];
}

// SourceConfig is the source file for load configuration
message SourceConfig {
  // name specifies the configuration name
  string name = 1 [json_name = "name"];

  // type specifies the type of the configuration source.
  // For built-in types, specify "env", "file", "etcd", "consul", "apollo", "nacos", "kubernetes", or "polaris".
  // For custom types, specify the registered name of the custom source.
  // When a custom type is used, its configuration should be placed in the 'customize' field.
  string type = 2 [json_name = "type"];

  // set the supported file format, if not set, all formats are supported
  repeated string formats = 3 [json_name = "formats"];

  // priority for this configuration source.
  // Sources will be loaded in ascending order of priority (e.g., 0, 1, 2, ...),
  // with later sources (higher priority value) overriding earlier ones.
  int32 priority = 4 [json_name = "priority"];

  // Configuration source specific settings. Only one of these should be set based on the 'type' field.
  optional EnvSource env = 10 [json_name = "env"];
  optional FileSource file = 11 [json_name = "file"];
  optional ETCDSource etcd = 12 [json_name = "etcd"];
  optional ConsulSource consul = 13 [json_name = "consul"];
  optional NacosSource nacos = 14 [json_name = "nacos"];
  optional ApolloSource apollo = 15 [json_name = "apollo"];
  optional KubernetesSource kubernetes = 16 [json_name = "kubernetes"];
  optional PolarisSource polaris = 17 [json_name = "polaris"];
  optional google.protobuf.Struct customize = 100 [json_name = "customize"];
}
