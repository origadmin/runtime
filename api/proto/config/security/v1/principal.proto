syntax = "proto3";

package runtime.api.config.security.v1;

import "google/protobuf/any.proto";
import "gnostic/openapi/v3/annotations.proto";
import "validate/validate.proto";

option go_package = "github.com/origadmin/runtime/api/gen/go/config/security/v1;securityv1";

// Principal represents the authenticated identity of a user or service.
// It serves as a standardized data transfer object for security context,
// carrying identity, roles, and various claims across service boundaries.
message Principal {
  // The unique identifier for the principal (e.g., user ID, service account name).
  string id = 1 [
    (validate.rules).string.min_len = 1,
    (gnostic.openapi.v3.property) = {description: "Unique identifier for the principal."}
  ];

  // A list of roles assigned to the principal.
  repeated string roles = 2 [
    (gnostic.openapi.v3.property) = {description: "List of roles assigned to the principal."}
  ];

  // A list of permissions assigned to the principal.
  repeated string permissions = 4 [
    (gnostic.openapi.v3.property) = {description: "List of permissions assigned to the principal."}
  ];

  // A map of scopes assigned to the principal.
  map<string, bool> scopes = 5 [
    (gnostic.openapi.v3.property) = {description: "Map of scopes assigned to the principal."}
  ];

  // A map of additional, non-structured claims associated with the principal.
  // Using `google.protobuf.Any` allows for type-safe, flexible claims that can
  // hold any protobuf message. In Go, helper functions should be provided to
  // wrap the complexity of packing and unpacking these `Any` values.
  map<string, google.protobuf.Any> extra_claims = 3 [
    (gnostic.openapi.v3.property) = {description: "Flexible, type-safe extra claims associated with the principal."}
  ];
}
