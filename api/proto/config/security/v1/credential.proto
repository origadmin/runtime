syntax = "proto3";

package runtime.api.config.security.v1;

import "gnostic/openapi/v3/annotations.proto";
import "google/protobuf/any.proto";

option go_package = "github.com/origadmin/runtime/api/gen/go/config/security/v1;securityv1";

// Credential is a generic container for transmitting credential data between services.
// It carries the raw credential string and optionally a parsed, structured payload.
message Credential {
  // Type indicates the kind of credential, e.g., "jwt", "apikey", "basic".
  // This helps the receiving service understand how to interpret the raw data or payload.
  string type = 1 [
    json_name = "type",
    (gnostic.openapi.v3.property) = {description: "Type of the credential (e.g., 'jwt', 'apikey')."}
  ];

  // Raw contains the original, unparsed credential string.
  // For example, the full "Bearer eyJ..." JWT string, or the API key string.
  string raw = 2 [
    json_name = "raw",
    (gnostic.openapi.v3.property) = {description: "Original, unparsed credential string."}
  ];

  // ParsedPayload optionally contains a structured representation of the credential.
  // This can be used if the sending service (e.g., Gateway) has already
  // performed some parsing and wants to avoid re-parsing on the receiving end.
  // The type of the message inside Any should correspond to the 'type' field.
  google.protobuf.Any parsed_payload = 3 [
    json_name = "parsed_payload",
    (gnostic.openapi.v3.property) = {description: "Optional structured payload of the credential."}
  ];
}
